<div class="main">

  <%= form_tag("/task/search") do %>
    <div class="form-group">
      <div class="input-content">
        <label>
          日付：<input type="date" class="input-date" name="search_date" value="<%= @limit_date %>"/>
        </label>
        <lavel>
          <input type="checkbox" id="input-check" name="close_display">
          <label for="close_display">完了したタスクを表示する</label>
        </lavel>
        <br><br>
        <input type="submit" class="btn-flat-border" value="検索">
      </div>
    </div>
  <% end %>

  <div class="container_wide">
    <h1>タスク一覧</h1>
    <table>
      <tr>
        <th>完了</th>
        <th>タイトル</th>
        <th>期限</th>
        <th>状況</th>
        <th>詳細</th>
        <th>操作</th>
      </tr>

      <% @tasks.each do |task| %>
        <tr>
          <td>
            <% if task.status == 0 %>
              <%= form_tag("/task/close") do %>
                <input type="hidden" class="input-text" name="id" value="<%= task.id %>"/>
                <input type="submit" class="btn btn-dark" value="完了">
              <% end %>
            <% else %>
              <%= form_tag("/task/cancel_status") do %>
                <input type="hidden" class="input-text" name="id" value="<%= task.id %>"/>
                <input type="submit" class="btn btn-dark" value="対応中に戻す">
              <% end %>
            <% end %>
          </td>

          <td>
            <%= task.title %>
          </td>
          <td>
            <%= task.limit_date %> <%= task.limit_time %>
            <% if (@today > task.limit_date) && (task.status != 1) %>
              <wrap class="error_limit">期限超過</wrap>
            <% end %>
          </td>

          <td>
            <%= simple_format(h(task.content)) %>
          </td>

          <td>
            <%= task.get_status %>
          </td>

          <td>
            <wrap class="">
              <%= link_to("詳細", "/task/show/#{task.id}") %>
            </wrap>
            <wrap class="link-button">
              <%= link_to("編集", "/task/edit/#{task.id}") %>
            </wrap>
            <wrap class="link-button">
              <%= link_to("削除", "/task/destroy/#{task.id}") %>
            </wrap>
          </td>
        </tr>
      <% end %>
    </table>
  </div>

  <wrap class="link-button">
    <%= link_to("新規登録", "/task/new") %>
  </wrap>

  <%= form_tag("/task/create_task_do") do %>
    <div class="form-group">
      <div class="input-content">
        <label>
          日付：<input type="date" class="input-date" name="search_date" value="<%= @limit_date %>"/>
        </label>
        <lavel>
          <input type="checkbox" id="input-check" name="close_display">
        </lavel>
        <br><br>
        <input type="submit" class="btn btn-dark" value="ルーティーン作成">
      </div>
    </div>
  <% end %>

</div>